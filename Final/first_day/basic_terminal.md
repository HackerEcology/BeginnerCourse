# 1.1基本终端命令

###为什么要使用命令行/如何开启命令行？

* 许多功能在图形界面不提供，只有通过命令行来实现。
* Finder会隐藏许多你不太会需要的文件，然而 command line 会允许你访问所有文件。
* 通过 command line 可以远程访问你的 Mac（利用 SSH）。
* administrators 用户可以通过 sudo 命令获得 root 用户权限。
* 通过 command-line script 可以使工作更高效。
* Terminal（终端）程序可以在“实用工具”里找到。
* 如果你开启手动输入用户名登陆模式，登陆时在用户名处输入 >con
sole 可以直接进入命令行界面。随后你仍然需要登录到一个账户。


###初识Command Line
- 许多命令会花费一些时间来执行，然而这中间不会给出任何提示或者进度条。一般结束后会出现一个“用户名$”的标记。如果没有出现，那么说明最后一条命令正在执行。
- 一条命令包括 Command Name、Options、Arguments、Extras 四个部分，但是后三个部分有时是可选的。Options 部分用-作为前导符。其中许多命令的 Options 部分只包含单个字母，这时可以合并。例如，ls -lA和ls -l -A是等效的。Arguments 部分用来细化这个命令或指定这个命令具体的实施对象，Extras 部分则用来进一步实现其他功能。
- 举例：以下新建了一个test.txt 并且删除了它

```
$ ls
$ cd
$ ls
$ cd Desktop
$ mkdir folder
$ cd folder
$ touch test.txt
$ rm test.txt
$ cd ..
$ rm -r folder
```

- 如果你输入了一些错误的命令，系统会返回一些错误信息。但是系统却不会阻止你做傻事（例如删除整个用户文件夹）。


### 关于 man 命令

虽然有上千条命令，每条命令还有许多可选参数和具体的使用方式，但是你却不需要记住这些命令。你只需要记住一个：man

大多数命令都会包含一个使用指南，会告诉你任何你需要知道的关于这个命令的所有细节，在命令行中输入 man command-name 即可获取。例如，你想知道ls这个命令怎么使用，输入man ls即可进入使用指南页面。

按Q来退出使用指南页面。

###命令行，文件和路径

>如果知道如何使用命令是掌握 command line 的第一步，那么第二步就是学习如何在 command line 中使用文件路径。如果你掌握了文件路径，你将会发现这比使用 Finder 更加快捷。

**注意**

command line 工具是大小写敏感的，并且对于文件名，必须包括扩展名。例如，你想找iTunes这个程序，输入itunes是无效的，必须输入iTunes.app。
Mac OS传统上喜欢使用“文件夹”（folders）这个名称，但是在 command line 中，主要使用“目录”（directory）这个词。这和 UNIX 是一致的。


###两种路径：绝对路径和相对路径

- 绝对路径：完整描述一个文件的位置，总是以斜杠（/）（forward slash）开头。例如/Users/michelle/Public/Drop Box。
- 相对路径：只描述一部分位置信息，它和你在 command line 目前的目录有关。当你打开新的 Terminal 程序时，command line 会话的目录应该是你的 home folder。这时上面例子文件夹的相对路径写作Public/Drop Box。显然它从当前目录开始。和html类似，你也可以使用两个点（“..”）来代表父目录，这样你就可以用相对路径表示上级或同级目录了。例如你可以输入cd ..甚至cd ../..

###切换到其他路径和目录

如果你想将当前 command line 会话切换到其他目录，需要用到三个命令：pwd，ls和cd。

- pwd的含义是“print working directory”，会显示当前目录的绝对路径。
- ls的含义是“list directory contents”，它会列出当前目录的内容。这个命令还有其他参数可选。
- cd的含义是“change directory”，它会改变当前目录到你指定的目录。如果你不指定，则会返回你的 home folder。

###查看隐藏文件

为了简化工作，command line 和 Finder 都会隐藏许多文件和文件夹，这些内容通常是系统需要的。不借助第三方工具让 Finder 显示隐藏文件比较困难，但是在 command line 中却非常简单。首先，许多隐藏文件的隐藏是通过隐藏属性在 Finder 中隐藏的，而 command line 会忽略这些属性，所以这些文件会在 command line 中显示。另外，ls命令会隐藏文件名以.开头的文件，但是这些文件却可以被显示出来，方法是利用-a选项。例如：

    $ ls -la

###用Command-Line管理文件

####检视文件

有许多基础命令用来定位、检视文件和文件夹，包括cat, less, which, file以及find。别忘了，你可以利用man命令来查阅每个命令的使用指南。

#### cat

cat是“concatenate”的意思，会按顺序读取文件并输出到 Terminal 窗口，语法为cat后接你需要查看的文件的路径。cat命令也可以用>>来增加文本文件的内容，例如命令cat ../textOne.txt >> textTwo.txt会把 textOne.txt 的内容添加到 textTwo.txt 的结尾。这个>>就属于上一篇提到的“Extras”。

####which

这个命令会定位某个命令的文件路径。换言之，它会告诉你你执行某个具体命令的时候，在使用哪个文件。语法为which后接某个命令。

###file

这个命令会尝试根据文件的内容输出文件类型。如果一个文件缺失了扩展名，那么这个命令可能会非常有用。语法为file后接文件路径。如图，此例为一个 PNG 文件，还给出了它的尺寸、颜色数等信息。

####find

这个命令用来根据搜索关键词定位文件路径。 find命令不使用 Spotlight 搜索服务，但是它允许你设置非常具体的搜索条件，以及通配符（稍后介绍）。语法为find后接搜索的起始路径，后接定义搜索的选项，后接搜索内容（包含在引号里）。

## 使用递归命令

简单来说，递归命令可以允许命令不执行于一个特定文件，而是指定的路径下的所有文件。大多数命令包含一个-r或者-R选项，来设定你想递归地执行这个命令。例如下面的例子，展示了添加-R后ls命令的执行方式：
```
ls
ls -R
```

##编辑文件和文件夹


有许多基础的命令用来编辑文件和文件夹，包括mkdir, cp, mv, rm, rmdir以及vi。下面我们来简要地介绍一下这些命令。

####mkdir

“make diretory”的缩写，用来创建文件夹，语法为mkdir后接新文件夹的目录。可以用-p选项，来一起创建路径中不存在的文件夹（这样你就不用挨层创建了）。

###cp

“copy”的缩写，用来把文件从一处复制到另一处。语法为cp后接原始路径，后接目标路径。如果你想复制整个文件夹和所有内容，需要添加-R选项。如果指定的目标路径不含文件名，则 cp 命令会按原名复制。如果指定的目标路径包括文件名，则会复制为你指定的文件名。如果仅指定新文件名，则会在原处以新名称创建文件副本。注意，系统会自动替换同名文件而不出现提示。

###mv

“move”的缩写，用来移动文件。语法为mv后接原路径，后接新路径。mv 的指定路径规则和 cp 是一样的（没错，如果仅指定新文件名，它就成了重命名命令）。

###rm

“remove”的缩写，会永久删除文件。注意，command-line中没有废纸篓。语法为rm后接文件路径。然而，使用 rm 命令删除的文件有可能可以通过数据恢复工具恢复。如果希望安全删除文件，可以使用srm命令。

###rmdir和rm -R

rmdir是“remove directory”的缩写，这个命令会永久删除文件夹。再强调一遍，CLI 中木有废纸篓。语法为rmdir后接希望删除目录的路径。然而，rmdir 命令无法删除含有任何其他文件的文件夹，所以大多数情形下rmdir命令是不适用的。不过，你可以利用rm添加-R选项来删除文件夹及包含的所有文件。

###vi

代表“visual”（视觉的），然而这个名称相当具有讽刺意味：vi可能是可视化效果最差的文本编辑器了。然而，vi 是 command line 中最常见的文本编辑器。用vi打开文本文件，只需要输入vi后接文件路径即可。Mac OS X 还提供了nano，一个更加现代的文本编辑器。它也更加方便，例如在底部包含了一个作弊小条（=_=），上面有常用的快捷键列表（你就不用背下来它们了）。然而，vi却有时是默认的文本编辑器，所以掌握vi是很有用的。

和less命令类似，vi命令会占用整个 Terminal 空间来显示文件内容。打开后，在“command模式”，vi 会等你输入一些预定义字符来告诉 vi 你想做什么。你也可以使用键盘上的箭头键单纯地浏览文件。你想编辑时，按A开始（会进入编辑模式）。文字会插入到光标处。如果你想保存，需要先退出编辑模式进入 command 模式。方法是按下esc键。回到 command 模式后，按住shift同时按两次Z来保存并退出。如果你不想保存，在 command 模式输入:quit!并按enter
return直接退出。

##用Command-Line管理系统

###使用su来切换用户

su命令代表“substitute user identity”，允许你在命令行中轻松切换到另一个用户账户。语法为su后接用户的短名称。然后会要求你输入密码（但是输入的时候不会显示）。执行完毕后，命令的前缀会改变，表示你拥有其他用户的权利。你可以利用who -m命令来验证当前登陆的身份。切换后，你会一直保持该用户身份，直至退出 Terminal 或者输入exit命令。

###关于sudo的使用

####sudo概述

更强大的命令就是sudo，代表“substitute user do”，或者，更恰当地，“super user do”。用sudo执行一个命令会使用 root 账户权限。当然，使用之前需要 administrator 账户（管理员账户）的授权（如输入密码）。

默认情况下，任何管理员账户都可以使用sudo来获取 root 权限，甚至当 root 账户在图形界面被禁用的情况下，sudo依然有效。这个命令是很多情况下我们不得不使用 Terminal 的原因，——同样也是给每个用户管理员身份的危险所在。不过，你可以调整sudo的配置文件，来限制它的使用。
提示：如果由于你忘了使用sudo而导致命令行返回一个错误，只需输入sudo !!就可以用sudo来执行上一条指令。

记住，权力越大责任越大。不恰当地使用sudo可以轻易破坏你的系统设置。命令行只会在你第一次执行严重破坏性行为之前提示你，之后，它就会假设你清楚自己正在干什么。如果你只掌握三条使用命令行的准则，那将是：总是仔细检查你的命令；总是使用Tab completion来帮助你避免拼写错误；使用sudo之前，总是仔仔细细检查你的命令。

###使用 sudo 切换 Shell

如果你是一个管理员用户，你需要执行很多条需要 root 权限的命令，你可以临时切换整个命令行 shell 来取得 root 级别的访问权限。方法就是先输入sudo -s，回车后再键入你的密码。

###其他Command-Line技巧提示

- 输入命令open .可以用 Finder 打开当前的位置。
- 在 Terminal 的偏好里面可以设定它的外观和风格。
- 中止一个错误的或者发疯的命令，可以使用组合键control + C。
- 你可以在执行前编辑命令，只需要使用箭头和键盘上的其他字母。
- 没有输入任何命令时，你可以用▲和▼来浏览历史命令。同样可以编辑和再次执行。
- 你也可以使用history命令查看历史记录。
- 你可以使用组合键control + L清屏。
